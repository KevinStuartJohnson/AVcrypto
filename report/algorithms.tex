\begin{algorithm} \label{legendresymbol} 
	\caption{The Legendre symbol of an integer $a$ modulo a prime $p$}
	\begin{algorithmic}[1]
		\Function{Legendre}{$a$,$p$}
			\State $s \leftarrow 1 $
			\For{$q \in  \text{FACTORS}(a)$}
				\State $s \leftarrow s * $\Call{LegendreForPrime}{$q$,$p$}
			\EndFor
			\Function{LegendreForPrime}{$q$,$p$} 
			  	\If{$q =1$}
			  		\State \Return $1$
			  	\ElsIf{$q \equiv 0 \text{ mod } p$}
			  		\State \Return $0$ 
			  	\ElsIf{$q = -1 $}
			  		\If{$p \equiv 1 \text{ mod } 4$}
			  			\State \Return $1$
			  		\Else
			  			\State \Return $-1$
			  		\EndIf
			  	\ElsIf{$q = 2$}
			  		\If{$p \equiv \pm 1 \text{ mod } 8$}
			  			\State \Return $1$
			  		\Else
			  			\State \Return $-1$
			  		\EndIf 
			  	\ElsIf{$q > p$}
			  		\State \Return \Call{LegendreForPrime}{$q \text{ mod } p$,$p$} 
			  	\ElsIf{$q \equiv 1 \text{ mod } 4$ or $p \equiv 1 \text{ mod } 4$}
			  		\State \Return \Call{LegendreForPrime}{$p$,$q$}
			  	\Else
			  		\State \Return $-$\Call{LegendreForPrime}{$p$,$q$}
			  	\EndIf
		  	\EndFunction
		  	\State \Return{$s$}
		\EndFunction
	\end{algorithmic} 
\end{algorithm} 

\begin{algorithm} \label{schoof}
	\caption{Schoofs algorithm to calculate the number of points on elliptic curve $\mathbb{E} : y^2 - x^3 - ax - b$ over $\mathbb{F}_p$}
	\begin{algorithmic}[1]
		\Function{Order}{$\mathbb{E}$,$p$}
			\State $S \leftarrow $ set of odd primes such that $\prod_{l \in S}l > 4\sqrt{p}$  
			\State $C \leftarrow \emptyset $
			\If{$\text{gcd}(x^p - x, x^3 + ax + b) = 1$}
				\State $C \leftarrow C \cup \lbrace (2,1) \rbrace $
			\Else 
				\State $C \leftarrow C \cup \lbrace (2,0) \rbrace $
			\EndIf

			\For{$l \in S$}
				\State $\psi_l \leftarrow $ \Call{DivisionPolynomial}{$l$} 
				\State $p_l = p \text{ mod } l$
				\State $(x^\prime,y^\prime) \leftarrow (x^{p^2},y^{p^2}) \oplus [p_l](x,y) $ 
				\For {$t \in \lbrace 1,2, ..., \frac{l-1}{2} \rbrace $}
					\State $(x_{t},y_{t}) = [t](x,y)$
					\If{$x^\prime = x_t \text{ mod } \psi_l$}
						\If{$\frac{(y^\prime - y_t)}{y} = 0 \text{ mod } \psi_l$}
							\State $C \leftarrow C \cup \lbrace (l,t) \rbrace $
						\Else
							\State $C \leftarrow C \cup \lbrace (l,-t) \rbrace $
						\EndIf
						\State Next $l$
					\EndIf
				\EndFor 
				\If{$p = w^2 \text{ mod } l$ for some $w\in Z$}
					\If{$\text{gcd}(\text{numerator}(x^p - x_w),\psi_l) = 1$}
						\State $C \leftarrow C \cup \lbrace (l,0) \rbrace $
					\Else
						\If{$\text{gcd}(\text{numerator}(\frac{y^p - y_w}{y}),\psi_l) = 1$}
							\State $C \leftarrow C \cup \lbrace (l,-2w) \rbrace $
						\Else
							\State $C \leftarrow C \cup \lbrace (l,2w) \rbrace $
						\EndIf 
					\EndIf
				\Else
					\State $C \leftarrow C \cup \lbrace (l,0) \rbrace $
				\EndIf 
			\EndFor 
			\State \Return{\Call{ChineseRemainderTheorem}{C}} 
	  	\EndFunction
	\end{algorithmic} 
\end{algorithm} 

